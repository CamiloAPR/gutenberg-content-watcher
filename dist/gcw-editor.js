(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,r=window.wp.plugins,n=window.wp.editPost,s=window.wp.components,a=window.wp.data,l="ok",i="warn",c="error",o=e=>{let t=null,r=e.match(/(src|href)="(.*?)"/);return r&&r.length>=3&&(t=r[2]),t},m=(e,t="14px",r="Roboto, arial, sans-serif")=>{const n=(m.canvas||(m.canvas=document.createElement("canvas"))).getContext("2d");return n.font=`normal ${t} ${r}`,n.measureText(e).width},u=(e,t,r,n,s)=>{Array.isArray(n)&&(n=n.filter((e=>!!e)));const a=1===n||n.length>0;return{res:a?e:l,message:a?t:r,occurrences:n,hint:s}},d=(e,t,r)=>({selector:e?`.editor-styles-wrapper ${e}`:null,title:t,searchTerm:r||t}),g=e=>{let t="All images have alt text.",r=0;return-1!==e.indexOf("<img")?(r=e.match(/<img(.*)alt=""(.*?)>/g)||[],r=r.map((e=>{let t=o(e),r=null;return r=t?d(`img[src="${t}"]`,t.split("/").pop()):d(null,"Found an empty block image."),r}))):t="No issues with images.",u(c,"Found images missing the alt text.",t,r,"")},p=e=>{let t="All iframes are being lazyloaded.",r=e.match(/<iframe(.*)>/g)||[],n=r.length;return r=r.filter((e=>-1===e.indexOf('loading="lazy"'))),0===n&&(t="No issues with iframes."),r.length>0&&(r=r.map((e=>{let t=o(e),r=null;return t&&(r=d(`iframe[src="${t}"]`,t)),r}))),u(c,'Found iframes that are missing the loading="lazy" property.',t,r,'Add loading="lazy" to the iframe code.')},h=(e,t,r,n,s=!0)=>{let a=`${e} length should be under ${n}px.`,l=`${e} length is under ${n}px.`,i=1;if(null===t||""==t)a=`${e} is empty.`;else{let e=Math.ceil(m(t,`${r}px`));if(e<=n&&(i=0),s){let t=` [Currently ~${e}px or more]`;i?a+=t:l+=t}}return{errorMessage:a,okMessage:l,occurrences:i}},w=()=>{const e=(0,a.select)("core/editor").getEditedPostAttribute("title"),{errorMessage:t,okMessage:r,occurrences:n}=h("Post's title",e,20,580);return u(c,t,r,n,"")},f=()=>{const e=document.querySelector("#yoast-snippet-preview-container > div:first-child > div:nth-of-type(2) span");if(e){const{errorMessage:t,okMessage:r,occurrences:n}=h("Post's meta title",e.textContent,20,580);return u(c,t,r,n,"")}return null},y=()=>{const e=document.getElementById("yoast_wpseo_metadesc");if(e){const{errorMessage:t,okMessage:r,occurrences:n}=h("Post's meta description",e.value,14,990,!0);return u(c,t,r,n,"")}return null},$=()=>{let e=0!==(0,a.select)("core/editor").getEditedPostAttribute("featured_media");return u(c,"The post is missing a featured image.","Featured image set correctly.",e?0:1,"")},E=e=>{let t="All inner anchor links are set properly.",r=e.match(/<a(.*)href="#(.+?)">(.*?)<\/a>/g)||[];return 0===r.length&&(t="No issues with inner anchor links."),r=r.map((t=>{let r=t.match('"#(.*?)"'),n=null;var s;return r&&(r=r.pop().replace('"',""),-1===e.indexOf(`id="${r}"`)&&-1===e.indexOf(`anchor="${r.replace("rank-table-","")}"`)&&(n=d(null,`${s=t,s.replace(/<(.*?)>(.*)<\/(.*?)>/g,"$2").replace(/(<([^>]+)>)/gi,"")} -> #${r}`))),n})),u(c,"Found broken anchor links.",t,r,"")},b=window.wp.domReady,x=()=>{const e=(()=>{const{getEditedPostContent:e}=(0,a.select)("core/editor"),t=e();let r={[l]:{title:"Passed Assestments",items:[]},[c]:{title:"Errors",items:[]},[i]:{title:"Warnings",items:[]},info:{title:"General Info",items:[]}};return[w(),f(),y(),g(t),$(),E(t),p(t)].filter((e=>null!=e)).forEach((e=>{r[e.res].items=[...r[e.res].items,e]})),r})(),r=Object.keys(e);return(0,t.createElement)(n.PluginSidebar,{name:"gcw",title:"Gutenberg Content Watcher",className:"gcw-panel",icon:`welcome-view-site gcw-icon gcw-icon-status-${A(e[c],e[i])}`},r.map((r=>{const{title:n,items:a}=e[r];return r===l&&a.length>0?(0,t.createElement)(s.PanelBody,{className:`incident-wrapper status-${r}`,title:`[${a.length}] ${n}`,initialOpen:r===c||r===l},(0,t.createElement)("ol",{className:"incident-list"},a.map(((e,n)=>(0,t.createElement)("li",{className:"incident",id:`type-${r}-${n}`,"data-type":e.type},(0,t.createElement)(t.RawHTML,null,e.message),e.occurrences.length>0&&(0,t.createElement)("span",{className:"incident-occurrences"},"(",e.occurrences.length,")")))))):a.map((e=>Array.isArray(e.occurrences)&&e.occurrences.length>0?v(e,r):k(e,r)))})))},k=(e,r)=>(0,t.createElement)(s.PanelBody,{className:`incident-wrapper no-children status-${r}`,title:`${e.message}`}),v=(e,r)=>(0,t.createElement)(s.PanelBody,{className:`incident-wrapper status-${r}`,title:`[${e.occurrences.length}] ${e.message}`,initialOpen:!0},(0,t.createElement)("ol",{className:"incident-list"},e.occurrences.map((e=>(0,t.createElement)(P,{...e}))))),P=({selector:e,title:r,searchTerm:n})=>{let s=null;return s=e?(0,t.createElement)("a",{href:"","data-selector":e,onClick:t=>{t.preventDefault();let r=document.querySelector(e);null===r&&(r=N("textarea",n)),r&&r.scrollIntoView({behavior:"smooth",block:"center"})}},r):r,(0,t.createElement)("li",{className:"incident"}," ",s)},N=(e,t)=>{for(var r,n=document.getElementsByTagName(e),s=0;s<n.length;s++)if(-1!==n[s].textContent.indexOf(t)){r=n[s];break}return r},A=(e,t)=>{let r="ok";return e.items.length>0?r="error":t.items.length>0&&(r="warn"),r};e.n(b)()((function(){(0,r.registerPlugin)("gcw",{render:x})}))})();